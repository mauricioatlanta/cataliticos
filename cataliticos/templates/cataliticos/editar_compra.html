{% extends 'base.html' %}
{% load humanize %}
{% load formato_moneda %}

{% block title %}Editar Compra Futurista{% endblock %}

{% block content %}
<style>
.futuristic-bg {
  background: radial-gradient(ellipse at 60% 40%, #00fff7 0%, #0a0a23 60%, #000 100%);
  position: fixed;
  inset: 0;
  z-index: 0;
  opacity: 0.7;
  filter: blur(8px);
}
.futuristic-orbit {
  position: absolute;
  left: 50%;
  top: 50%;
  width: 420px;
  height: 420px;
  margin-left: -210px;
  margin-top: -210px;
  border: 2px dashed #00fff7;
  border-radius: 50%;
  opacity: 0.18;
  animation: spin 22s linear infinite;
  z-index: 1;
}
@keyframes spin { 100% { transform: rotate(360deg); } }
.futuristic-card {
  position: relative;
  z-index: 2;
  background: rgba(10,20,40,0.96);
  border-radius: 2.5rem;
  box-shadow: 0 0 80px 0 #00fff7, 0 0 0 2px #00fff733;
  padding: 3rem 2rem 2rem 2rem;
  max-width: 600px;
  margin: 0 auto;
  font-family: 'Orbitron', 'Montserrat', sans-serif;
}
.futuristic-card label {
  color: #00fff7;
  font-weight: 700;
  letter-spacing: 1px;
  text-shadow: 0 0 8px #00fff7cc;
}
.futuristic-card input, .futuristic-card select {
  background: rgba(0,0,0,0.7);
  border: 1.5px solid #00fff7;
  color: #fff;
  font-size: 1.1rem;
  border-radius: 0.7rem;
  padding: 0.7rem 1rem;
  margin-bottom: 1.2rem;
  width: 100%;
  outline: none;
  box-shadow: 0 0 12px #00fff755 inset;
  transition: border 0.2s, box-shadow 0.2s;
}
.futuristic-card input:focus, .futuristic-card select:focus {
  border: 2px solid #fff;
  box-shadow: 0 0 24px #00fff7cc;
}
.futuristic-btn {
  background: linear-gradient(90deg, #00fff7 0%, #0a0a23 100%);
  color: #fff;
  border: none;
  border-radius: 1rem;
  font-size: 1.1rem;
  font-weight: 700;
  padding: 0.8rem 2.2rem;
  margin: 0 0.5rem;
  box-shadow: 0 0 18px #00fff7cc;
  transition: background 0.2s, box-shadow 0.2s;
}
.futuristic-btn:hover {
  background: linear-gradient(90deg, #0a0a23 0%, #00fff7 100%);
  box-shadow: 0 0 32px #00fff7;
}
.futuristic-title {
  font-size: 2.5rem;
  color: #fff;
  text-align: center;
  font-weight: 900;
  letter-spacing: 2px;
  margin-bottom: 2.2rem;
  text-shadow: 0 0 24px #00fff7, 0 0 8px #fff;
}
</style>
<div style="position:relative; min-height: 100vh;">
  <div class="futuristic-bg"></div>
  <div class="futuristic-orbit"></div>
  <div class="futuristic-card mt-16 mb-16">
    <div class="futuristic-title">üõ∏ Editar Compra</div>
    <form method="post" autocomplete="off">
      {% csrf_token %}
      {% for field in form %}
        <div class="mb-4">
          <label for="{{ field.id_for_label }}">{{ field.label }}</label>
          {{ field }}
          {% if field.help_text %}<div class="text-cyan-300 text-xs mt-1">{{ field.help_text }}</div>{% endif %}
          {% for error in field.errors %}<div class="text-red-400 text-xs mt-1">{{ error }}</div>{% endfor %}
        </div>
      {% endfor %}
      <hr class="my-8 border-cyan-700">
      <h3 class="text-xl neon font-bold mb-4 text-center">Catal√≠ticos de la compra</h3>
      {% for detalle_form in formset %}
        <div class="mb-6 p-4 rounded-xl bg-black/40 shadow-lg">
          {% for field in detalle_form %}
            <label for="{{ field.id_for_label }}" class="block text-cyan-300 font-bold">{{ field.label }}</label>
            {{ field }}
            {% if field.help_text %}<div class="text-cyan-300 text-xs mt-1">{{ field.help_text }}</div>{% endif %}
            {% for error in field.errors %}<div class="text-red-400 text-xs mt-1">{{ error }}</div>{% endfor %}
          {% endfor %}
          {% if detalle_form.instance.catalitico %}
            <div class="mt-3 p-3 rounded-lg bg-black/60 border border-cyan-700">
              <div class="text-cyan-200 text-sm mb-1"><strong>Descripci√≥n:</strong> {{ detalle_form.instance.catalitico.descripcion }}</div>
              <div class="text-cyan-200 text-sm mb-1"><strong>Proveedor:</strong> {{ detalle_form.instance.catalitico.proveedor }}</div>
              {% if detalle_form.instance.catalitico.imagen_principal %}
                <div class="mb-2"><img src="{{ detalle_form.instance.catalitico.imagen_principal.url }}" alt="Imagen principal" style="max-width:120px; border-radius:12px; box-shadow:0 0 12px #00fff7;"></div>
              {% endif %}
              {% if detalle_form.instance.catalitico.imagen2 %}
                <div class="mb-2"><img src="{{ detalle_form.instance.catalitico.imagen2.url }}" alt="Imagen 2" style="max-width:120px; border-radius:12px; box-shadow:0 0 12px #00fff7;"></div>
              {% endif %}
              {% if detalle_form.instance.catalitico.imagen3 %}
                <div class="mb-2"><img src="{{ detalle_form.instance.catalitico.imagen3.url }}" alt="Imagen 3" style="max-width:120px; border-radius:12px; box-shadow:0 0 12px #00fff7;"></div>
              {% endif %}
              {% if detalle_form.instance.catalitico.imagen4 %}
                <div class="mb-2"><img src="{{ detalle_form.instance.catalitico.imagen4.url }}" alt="Imagen 4" style="max-width:120px; border-radius:12px; box-shadow:0 0 12px #00fff7;"></div>
              {% endif %}
            </div>
          {% endif %}
        </div>
      {% endfor %}
      <div class="flex gap-4 justify-center mt-8">
        <button type="submit" class="futuristic-btn">üíæ Guardar</button>
        <a href="{% url 'cataliticos:listado_compras' %}" class="futuristic-btn">Cancelar</a>
        <a href="{% url 'cataliticos:eliminar_compra' compra.id %}" class="futuristic-btn bg-red-600" onclick="return confirm('¬øSeguro que deseas eliminar esta compra?');">üóëÔ∏è Eliminar Compra</a>
      </div>
    </form>
  </div>
  </div>
</div>
{% endblock %}
